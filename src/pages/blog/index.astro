---
import { getCollection, type CollectionEntry } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";

const posts: CollectionEntry<"blog">[] = (await getCollection("blog"))
  .filter((post: CollectionEntry<"blog">) => !post.data.draft)
  .sort(
    (a: CollectionEntry<"blog">, b: CollectionEntry<"blog">) =>
      b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
  );
---

<BaseLayout title="Blog | Wayne Mwashuma" description="Articles and notes by Wayne Mwashuma">
  <main class="blog-page">
    <h1>Blog</h1>
    <p>Notes on building, learning, and shipping.</p>

    <ul class="blog-list">
      {posts.map((post) => (
        <li>
          <article>
            <h2>
              <a href={`/blog/${post.id}/`}>{post.data.title}</a>
            </h2>
            <p>{post.data.description}</p>
            <small>
              {post.data.pubDate.toLocaleDateString("en-US", {
                year: "numeric",
                month: "long",
                day: "numeric"
              })}
            </small>
          </article>
        </li>
      ))}
    </ul>
  </main>
</BaseLayout>

<style>
  .blog-page {
    max-width: 760px;
    margin: 0 auto;
    padding: 4rem 1rem;
  }

  .blog-list {
    list-style: none;
    padding: 0;
    margin: 2rem 0 0;
    display: grid;
    gap: 1.5rem;
  }

  .blog-list li {
    border: 1px solid #d9d9d9;
    border-radius: 10px;
    padding: 1.25rem;
  }

  h2 {
    margin: 0 0 0.5rem;
  }

  h2 a {
    color: inherit;
    text-decoration: none;
  }

  h2 a:hover {
    text-decoration: underline;
  }
</style>
